{% extends "base.html" %}

{% load static %}

{% block 'header' %}
    <link rel="stylesheet" href="{% static 'css/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/per.css' %}">
    <link rel="stylesheet" href="{% static 'css/modal.css' %}">
{% endblock 'header' %}

{% block 'body' %}
{% include 'modals/message.html' %}
{% include 'modals/photo.html' %}
<main>
    <div id="perfil">
        <nav>
            <img src="https://i.pinimg.com/736x/5d/82/5d/5d825d5590e0b0ad9a3024e96ffef5d1.jpg" alt="background" id="background">
            <img src="
                {% if binary_perfil %}
                    {{binary_perfil}}
                {% endif %}
            " alt="
                {% if binary_perfil %}
                    {{name}}
                {% else %}
                    add photo
                {% endif %}
            " id="photo_perfil">
            <ul>
                <li id="name">{{name}}</li>
                <li id="bio">
                    {% if bio %}
                        {{bio}}
                    {% else %}
                        <p id="add_bio">add your bio <span class="fa fa-pencil"></span></p>
                    {% endif %}
                </li>
                <li><button id="new_post">new post</button><input type="file" id="new_file"></li>
            </ul>
        </nav>
    </div>
    <div id="post">
        <p><span class="fa fa-bookmark-o"></span>post</p>
        <input type="hidden" id="binary_post" value="{{binary_post}}">
        <input type="hidden" id="date_post" value="{{date_post}}">
        <input type="hidden" id="comments_post" value="{{comments_post}}">
        <div id="post_content">
        </div>
    </div>
</main>
<script src='{% static "js/perfi.js" %}'></script>
<script src="{% static 'js/modals.js' %}"></script>
<script>
    async function get_post(){
        const resp = await fetch('/img')

        const data = resp.json()
        return data
    }

    function generate_post(data={}){

        tam = data.binary.length

        let space = document.querySelector("#post_content")

        for(let n = 0; n < tam; n++){
            let div = document.createElement('div')
            div.setAttribute('class','content')
            let img = document.createElement("img")
            img.src = data.binary[n]
            img.alt = ''
            let date = document.createElement('p')
            date.innerHTML = `<span class="fa fa-calendar"></span>${data.date[n]}`
            div.appendChild(img)
            div.appendChild(date)
            space.appendChild(div)
        }
    }

    get_post().then(data=>generate_post(data))
</script>
{% endblock 'body' %}
